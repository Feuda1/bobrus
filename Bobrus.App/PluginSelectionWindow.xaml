<Window x:Class="Bobrus.App.PluginSelectionWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Выбор плагинов" Height="550" Width="900"
        MinHeight="450" MinWidth="600"
        WindowStartupLocation="CenterOwner"
        WindowStyle="None"
        ResizeMode="CanResize"
        Background="{DynamicResource BackgroundBrush}"
        Foreground="{DynamicResource TextPrimaryBrush}">
    
    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="0"
                      ResizeBorderThickness="6"
                      CornerRadius="0"
                      GlassFrameThickness="0"
                      UseAeroCaptionButtons="False" />
    </WindowChrome.WindowChrome>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="60"/>
        </Grid.RowDefinitions>

        <!-- Title Bar -->
        <Grid Grid.Row="0" Background="{DynamicResource TopBarBrush}" MouseLeftButtonDown="OnTitleBarMouseDown">
            <TextBlock Text="Выбор плагинов" 
                       VerticalAlignment="Center" 
                       Margin="16,0,0,0" 
                       FontSize="16" 
                       FontWeight="SemiBold"/>
            
            <Button Style="{StaticResource WindowCloseButton}" 
                    HorizontalAlignment="Right" 
                    Margin="0,0,10,0"
                    Click="OnCloseClicked">
                 <Viewbox Stretch="Uniform" Width="12" Height="12">
                     <Path Stroke="{DynamicResource TextPrimaryBrush}"
                           StrokeThickness="2"
                           StrokeEndLineCap="Round"
                           StrokeStartLineCap="Round"
                           Data="M2,4 L14,16 M14,4 L2,16" />
                 </Viewbox>
            </Button>
        </Grid>

        <!-- Search -->
        <Border Grid.Row="1" Margin="16,16,16,0" Style="{StaticResource CardBorder}" Padding="10">
            <DockPanel>
                <TextBlock Text="Поиск:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBox x:Name="SearchBox" 
                         Height="32"
                         VerticalContentAlignment="Center"
                         Padding="8 0"
                         Background="{DynamicResource SurfaceBrush}"
                         Foreground="{DynamicResource TextPrimaryBrush}"
                         BorderBrush="{DynamicResource BorderBrushMuted}"
                         BorderThickness="1"
                         CaretBrush="{DynamicResource TextPrimaryBrush}"
                         TextChanged="OnSearchTextChanged"/>
            </DockPanel>
        </Border>

        <!-- Content -->
        <Grid Grid.Row="2" Margin="16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="16"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Plugins List -->
            <Border Grid.Column="0" Style="{StaticResource CardBorder}">
                <DockPanel>
                    <TextBlock Text="Доступные плагины" DockPanel.Dock="Top" Margin="0,0,0,10" FontWeight="SemiBold"/>
                    <ListBox x:Name="PluginsList" 
                             SelectionChanged="OnPluginSelected" 
                             DisplayMemberPath="DisplayName"
                             Background="Transparent"
                             BorderThickness="0"/>
                </DockPanel>
            </Border>

            <!-- Versions List -->
            <Border Grid.Column="2" Style="{StaticResource CardBorder}">
                <DockPanel>
                    <TextBlock Text="Версии" DockPanel.Dock="Top" Margin="0,0,0,10" FontWeight="SemiBold"/>
                    <ListBox x:Name="VersionsList" 
                             SelectionChanged="OnVersionSelected" 
                             DisplayMemberPath="DisplayName"
                             Background="Transparent"
                             BorderThickness="0"/>
                </DockPanel>
            </Border>
        </Grid>

        <!-- Footer -->
        <Border Grid.Row="3" Background="{DynamicResource PanelBrush}" BorderBrush="{DynamicResource BorderBrushMuted}" BorderThickness="0,1,0,0">
            <Grid Margin="16,0">
                <TextBlock x:Name="StatusText" 
                           VerticalAlignment="Center" 
                           HorizontalAlignment="Left" 
                           Text="Готово" 
                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Отмена" 
                            Click="OnCloseClicked" 
                            Style="{StaticResource StandardButton}" 
                            Padding="16,6"
                            MinWidth="80"
                            Margin="0,0,10,0"/>
                    <Button x:Name="AddButton" 
                            Content="Добавить" 
                            Click="OnAddClicked" 
                            Style="{StaticResource PrimaryButton}" 
                            Padding="16,6"
                            MinWidth="80"
                            IsEnabled="False"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
