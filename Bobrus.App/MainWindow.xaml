<Window x:Class="Bobrus.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Bobrus.App"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="Bobrus"
        Height="520"
        Width="1024"
        MinHeight="640"
        MinWidth="900"
        WindowStartupLocation="CenterScreen"
        Language="ru-RU"
        WindowStyle="None"
        ResizeMode="CanResize"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True"
        Background="{StaticResource BackgroundBrush}">
    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="0"
                      ResizeBorderThickness="8"
                      CornerRadius="0"
                      GlassFrameThickness="0"
                      UseAeroCaptionButtons="False" />
    </WindowChrome.WindowChrome>

    <Grid Background="{StaticResource BackgroundBrush}" x:Name="RootGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Top bar -->
        <Grid Grid.Row="0"
              Background="{StaticResource TopBarBrush}"
              Height="60"
              Margin="0 6 0 0"
              SnapsToDevicePixels="True"
              MouseLeftButtonDown="OnTopBarMouseDown">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <StackPanel Orientation="Horizontal" Margin="14 0 12 0" VerticalAlignment="Center">
                <TextBlock Text="bobrus" FontSize="20" FontWeight="Bold" />
                <TextBlock x:Name="VersionText"
                           Margin="10 0 0 0"
                           VerticalAlignment="Center"
                           Foreground="{StaticResource TextSecondaryBrush}" />
            </StackPanel>

            <Grid Grid.Column="1" />

            <Grid Grid.Column="2" VerticalAlignment="Center" Margin="0 0 12 0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal" Grid.Column="0" VerticalAlignment="Center" Margin="0 0 12 0">
                    <Button x:Name="CheckUpdatesButton"
                            Width="130"
                            Style="{StaticResource BaseButton}"
                            Click="OnCheckUpdatesClicked">
                        Проверить обновления
                    </Button>
                    <TextBlock x:Name="UpdateStatusText"
                               VerticalAlignment="Center"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               Margin="8 0 0 0" />
                </StackPanel>

                <StackPanel Orientation="Horizontal" Grid.Column="1" VerticalAlignment="Center" Margin="10 0 0 0">
                    <Button Style="{StaticResource WindowIconButton}"
                            Click="OnMinimizeClicked">
                        <Viewbox Stretch="Uniform" Width="16" Height="16">
                            <Path Stroke="{StaticResource TextPrimaryBrush}"
                                  StrokeThickness="1.8"
                                  StrokeEndLineCap="Round"
                                  StrokeStartLineCap="Round"
                                  Data="M2,6 L8,12 L14,6" />
                        </Viewbox>
                    </Button>
                    <Button Style="{StaticResource WindowIconButton}"
                            Margin="6 0 0 0"
                            Click="OnToggleMaximizeClicked">
                        <Viewbox Stretch="Uniform" Width="16" Height="16">
                            <Path Stroke="{StaticResource TextPrimaryBrush}"
                                  StrokeThickness="1.8"
                                  StrokeEndLineCap="Round"
                                  StrokeStartLineCap="Round"
                                  Data="M2,10 L8,4 L14,10" />
                        </Viewbox>
                    </Button>
                    <Button Style="{StaticResource WindowCloseButton}"
                            Margin="6 0 0 0"
                            Click="OnCloseClicked">
                        <Viewbox Stretch="Uniform" Width="16" Height="16">
                            <Path Stroke="{StaticResource TextPrimaryBrush}"
                                  StrokeThickness="1.8"
                                  StrokeEndLineCap="Round"
                                  StrokeStartLineCap="Round"
                                  Data="M2,4 L14,16 M14,4 L2,16" />
                        </Viewbox>
                    </Button>
                </StackPanel>
            </Grid>
        </Grid>

        <!-- Search bar -->
        <Grid Grid.Row="1" Margin="16 12 16 8">
            <Border Background="{StaticResource SurfaceBrush}"
                    BorderBrush="{StaticResource BorderBrushMuted}"
                    BorderThickness="1"
                    CornerRadius="10"
                    Padding="10 8">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Viewbox Width="18" Height="18" VerticalAlignment="Center">
                        <Path Stroke="{StaticResource TextSecondaryBrush}"
                              StrokeThickness="1.6"
                              StrokeLineJoin="Round"
                              StrokeStartLineCap="Round"
                              StrokeEndLineCap="Round"
                              Data="M7.5,2 A5.5,5.5 0 1 1 2,7.5 A5.5,5.5 0 0 1 7.5,2 M11.5,11.5 L16,16" />
                    </Viewbox>
                    <TextBox x:Name="SearchBox"
                             Grid.Column="1"
                             Margin="10 0 0 0"
                             Background="Transparent"
                             BorderThickness="0"
                             Foreground="{StaticResource TextPrimaryBrush}"
                             CaretBrush="{StaticResource AccentBrush}"
                             FontSize="14"
                             TextChanged="OnSearchTextChanged"
                             KeyDown="OnSearchKeyDown"
                             Tag="Поиск функций (Ctrl+K)"
                             />
                </Grid>
            </Border>
        </Grid>

        <!-- Main layout -->
        <Grid Grid.Row="2" Margin="16 0 16 16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*" />
                <ColumnDefinition Width="1*" />
            </Grid.ColumnDefinitions>

                <!-- Content area -->
                <ScrollViewer Grid.Column="0"
                              VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled"
                              Padding="0"
                              Margin="0 0 0 0">
                    <StackPanel Orientation="Vertical">
                        <!-- System functions -->
                        <Border x:Name="SystemCard" Style="{StaticResource CardBorder}" Padding="18" Margin="0 0 0 14">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <TextBlock Text="Системные функции"
                                           FontSize="18"
                                           FontWeight="SemiBold"
                                           Margin="0 0 0 14" />

                                <WrapPanel x:Name="ActionsPanel" Grid.Row="1" Margin="0" HorizontalAlignment="Stretch">
                                    <Button Content="Перезагрузить ПК"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnRebootClicked"
                                            Tag="reboot перезагрузка рестарт" />
                                    <Button x:Name="TouchToggleButton"
                                            Content="Сенсор: проверка..."
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnTouchToggleClicked"
                                            Tag="сенсор touch включить отключить" />
                                    <Button Content="Перезапуск сенсора"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnRestartTouchClicked"
                                            Tag="сенсор перезапуск touch reset" />
                                    <Button Content="Перезапуск COM-портов"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnRestartComClicked"
                                            Tag="com port serial rs232" />
                                    <Button Content="Перезапуск и очистка дисп. печати"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="230"
                                            Margin="0 12 12 12"
                                            Click="OnRestartPrintSpoolerClicked"
                                            Tag="печать spooler очередь принтер" />
                                    <Button Content="Настройка TLS 1.2"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnConfigureTlsClicked"
                                            Tag="tls ssl протокол" />
                                    <Button Content="Очистить мусор"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnCleanupClicked"
                                            Tag="очистка temp кеш cache браузер" />
                                    <Button Content="Отключить защиту и брандмауэр"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="220"
                                            Margin="0 12 12 12"
                                            Click="OnDisableSecurityClicked"
                                            Tag="defender firewall защита брандмауэр отключить" />
                                </WrapPanel>
                            </Grid>
                        </Border>

                        <!-- IIKO functions -->
                        <Border x:Name="IikoCard" Style="{StaticResource CardBorder}" Padding="18" Margin="0 0 0 14">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <TextBlock Text="IIKO"
                                           FontSize="18"
                                           FontWeight="SemiBold"
                                           Margin="0 0 0 14" />

                                <WrapPanel x:Name="IikoActionsPanel" Grid.Row="1" Margin="0" HorizontalAlignment="Stretch">
                                    <Button Content="Закрыть iikoFront"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="180"
                                            Margin="0 12 12 12"
                                            Click="OnCloseIikoFrontClicked"
                                            Tag="iiko front закрыть завершить процесс" />
                                    <Button Content="Перезапустить iikoFront"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="200"
                                            Margin="0 12 12 12"
                                            Click="OnRestartIikoFrontClicked"
                                            Tag="iiko front перезапуск restart" />
                                    <Button Content="Обновить iikoCard"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="180"
                                            Margin="0 12 12 12"
                                            Click="OnUpdateIikoCardClicked"
                                            Tag="iiko card обновление installer" />
                                </WrapPanel>
                            </Grid>
                        </Border>

                        <!-- Logs -->
                        <Border x:Name="LogsCard" Style="{StaticResource CardBorder}" Padding="18" Margin="0 0 0 14">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <TextBlock Text="Логи"
                                           FontSize="18"
                                           FontWeight="SemiBold"
                                           Margin="0 0 0 14" />

                                <Grid Grid.Row="1">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>

                                    <WrapPanel Margin="0 0 0 12" HorizontalAlignment="Left" VerticalAlignment="Top">
                                        <TextBlock Text="Период:"
                                                   VerticalAlignment="Center"
                                                   Margin="0 0 10 0"
                                                   Foreground="{StaticResource TextSecondaryBrush}" />
                                        <DatePicker x:Name="LogStartDate"
                                                    SelectedDate="{x:Static sys:DateTime.Today}"
                                                    Width="150"
                                                    Margin="0 0 10 0" />
                                        <TextBlock Text="по"
                                                   VerticalAlignment="Center"
                                                   Margin="0 0 10 0"
                                                   Foreground="{StaticResource TextSecondaryBrush}" />
                                        <DatePicker x:Name="LogEndDate"
                                                    SelectedDate="{x:Static sys:DateTime.Today}"
                                                    Width="150"
                                                    Margin="0 0 20 0" />
                                        <CheckBox x:Name="IncludeCashServerToggle"
                                                  Content="Вся папка CashServer"
                                                  Margin="0 0 16 0"
                                                  Foreground="{StaticResource TextPrimaryBrush}" />
                                        <CheckBox x:Name="IncludeEntitiesToggle"
                                                  Content="База EntitiesStorage"
                                                  Margin="0 0 0 0"
                                                  Foreground="{StaticResource TextPrimaryBrush}" />
                                    </WrapPanel>

                                <WrapPanel x:Name="LogsActionsPanel" Grid.Row="1" Margin="0" HorizontalAlignment="Stretch">
                                    <Button Content="config.xml"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="150"
                                            Margin="0 12 12 12"
                                            Click="OnOpenConfigLogClicked"
                                            Tag="лог config cashserver конфиг конфик" />
                                    <Button Content="cash-server.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnOpenCashServerLogClicked"
                                            Tag="лог cash server cashserver кэшсервер кешсервер кеш сервер кэш сервер" />
                                    <Button Content="OnlineMarking.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="190"
                                            Margin="0 12 12 12"
                                            Click="OnOpenOnlineMarkingLogClicked"
                                            Tag="лог online marking маркировка марки честный знак чз" />
                                    <Button Content="dualConnector.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="190"
                                            Margin="0 12 12 12"
                                            Click="OnOpenDualConnectorLogClicked"
                                            Tag="лог dualconnector терминал оплата" />
                                    <Button Content="AlcoholMarking.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="190"
                                            Margin="0 12 12 12"
                                            Click="OnOpenAlcoholLogClicked"
                                            Tag="лог alcohol marking алкоголь алкашка" />
                                    <Button Content="Sberbank.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnOpenSberbankLogClicked"
                                            Tag="лог sberbank оплата сбер сбербанк банк" />
                                    <Button Content="virtual-printer.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="190"
                                            Margin="0 12 12 12"
                                            Click="OnOpenVirtualPrinterLogClicked"
                                            Tag="лог virtualprinter виртуалпринтер виртуал принтер принтер" />
                                    <Button Content="Error.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="140"
                                            Margin="0 12 12 12"
                                            Click="OnOpenErrorLogClicked"
                                            Tag="лог ошибки ошибка error еррор ерор" />
                                    <Button Content="Transport.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnOpenTransportLogClicked"
                                            Tag="лог transport плагин транспорт" />
                                    <Button Content="Delivery.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnOpenDeliveryLogClicked"
                                            Tag="лог delivery доставка деливери диливири диливери" />
                                    <Button Content="messages.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnOpenMessagesLogClicked"
                                            Tag="лог message messages месаге меседж месседж мэседж сообщения оповещения" />
                                    <Button Content="UTM transport_info.log"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="210"
                                            Margin="0 12 12 12"
                                            Click="OnOpenUtmTransportLogClicked"
                                            Tag="лог utm transport логи утм утм транспорт" />
                                    <Button Content="Собрать логи"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="160"
                                            Margin="0 12 12 12"
                                            Click="OnCollectLogsClicked"
                                            Tag="сбор логов logs архив" />
                                </WrapPanel>
                                </Grid>
                            </Grid>
                        </Border>

                        <!-- Folders -->
                        <Border x:Name="FoldersCard" Style="{StaticResource CardBorder}" Padding="18">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <TextBlock Text="Папки"
                                           FontSize="18"
                                           FontWeight="SemiBold"
                                           Margin="0 0 0 14" />

                                <WrapPanel x:Name="FoldersActionsPanel" Grid.Row="1" Margin="0" HorizontalAlignment="Stretch">
                                    <Button Content="Logs"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnOpenFolderLogsClicked"
                                            Tag="папка логи cashserver logs лог" />
                                    <Button Content="EntitiesStorage"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="190"
                                            Margin="0 12 12 12"
                                            Click="OnOpenFolderEntitiesClicked"
                                            Tag="папка entities storage энтитисторадже энтити сторадже бд база данных база" />
                                    <Button Content="CashServer"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnOpenFolderCashServerClicked"
                                            Tag="папка cashserver кэшсервер кешсервер кеш сервер кэш сервер" />
                                    <Button Content="Plugins"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="170"
                                            Margin="0 12 12 12"
                                            Click="OnOpenFolderPluginsClicked"
                                            Tag="папка front plugins плагин плагины" />
                                    <Button Content="UTM"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="140"
                                            Margin="0 12 12 12"
                                            Click="OnOpenFolderUtmClicked"
                                            Tag="папка utm утм" />
                                    <Button Content="PluginConfigs"
                                            Style="{StaticResource BaseButton}"
                                            Height="44"
                                            MinWidth="190"
                                            Margin="0 12 12 12"
                                            Click="OnOpenFolderPluginConfigsClicked"
                                            Tag="папка pluginconfigs plugin configs конфиги плагинов" />
                                </WrapPanel>
                            </Grid>
                        </Border>
                    </StackPanel>
                </ScrollViewer>

                    <!-- Log panel -->
                    <Border Style="{StaticResource CardBorder}" Grid.Column="1" Padding="16" Margin="12 0 0 0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0" Margin="0 0 0 12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Журнал"
                                           FontSize="16"
                                           FontWeight="SemiBold"
                                           VerticalAlignment="Center" />
                                <Button Content="Очистить"
                                        Style="{StaticResource BaseButton}"
                                        Width="120"
                                        Margin="10 0 0 0"
                                        Click="OnClearLogClicked"
                                        Grid.Column="1" />
                            </Grid>

                            <Border Grid.Row="2"
                                    Margin="0 10 0 0"
                                    Background="#0C0C10"
                                    BorderBrush="{StaticResource BorderBrushMuted}"
                                    BorderThickness="1"
                                    CornerRadius="8"
                                    Padding="10">
                                <RichTextBox x:Name="LogRichTextBox"
                                             Background="Transparent"
                                            BorderThickness="0"
                                            IsReadOnly="True"
                                            IsDocumentEnabled="False"
                                            IsHitTestVisible="True"
                                            VerticalScrollBarVisibility="Auto"
                                            HorizontalScrollBarVisibility="Disabled"
                                            Padding="0"
                                            Foreground="{StaticResource TextPrimaryBrush}">
                                    <FlowDocument>
                                        <Paragraph/>
                                    </FlowDocument>
                                </RichTextBox>
                            </Border>
                        </Grid>
                    </Border>
                </Grid>
        <!-- Notification stack -->
        <Grid Grid.RowSpan="3"
              IsHitTestVisible="False"
              VerticalAlignment="Bottom"
              HorizontalAlignment="Right"
              Margin="16 16 16 24">
            <StackPanel x:Name="NotificationStack"
                        Orientation="Vertical"
                        Width="320"
                        VerticalAlignment="Bottom" />
        </Grid>

        <!-- Confirmation overlay -->
        <Grid x:Name="ConfirmOverlay"
              Grid.RowSpan="3"
              Background="#88000000"
              Visibility="Collapsed">
            <Grid VerticalAlignment="Center" HorizontalAlignment="Center" Width="400">
                <Border Background="{StaticResource PanelBrush}"
                        BorderBrush="{StaticResource BorderBrushMuted}"
                        BorderThickness="1"
                        CornerRadius="10"
                        Padding="18">
                    <StackPanel>
                        <TextBlock x:Name="ConfirmTitle"
                                   FontSize="18"
                                   FontWeight="SemiBold"
                                   Margin="0 0 0 8" />
                        <TextBlock x:Name="ConfirmMessage"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   Margin="0 0 0 12" />
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="Отмена"
                                    Style="{StaticResource BaseButton}"
                                    Width="100"
                                    Margin="0 0 10 0"
                                    Click="OnConfirmCancelClicked" />
                            <Button Content="Подтвердить"
                                    Style="{StaticResource AccentButton}"
                                    Width="120"
                                    Click="OnConfirmAcceptClicked" />
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</Window>
